// =======================================================
// brainChannelAdapter.js
// تكييف الرسالة حسب قناة الإرسال
// =======================================================

function adaptMessageToChannel(response, channel = "web") {
  if (!response || !response.answer) return response;

  let msg = response.answer;

  if (channel === "whatsapp") {
    msg = msg
      .replace(/<br>/g, "\n")
      .replace(/<[^>]+>/g, "")
      .trim();
  }

  if (channel === "facebook") {
    msg = msg.replace(/<[^>]+>/g, "");
  }

  return {
    ok: true,
    provider: response.provider,
    answer: msg
  };
}

module.exports = { adaptMessageToChannel };
